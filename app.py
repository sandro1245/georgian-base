import numpy as np
from flask import Flask, render_template, request,redirect, Markup, jsonify
from flask_socketio import SocketIO, emit, send ,join_room, leave_room
import datetime
from cryptography.fernet import Fernet
import json
import mysql.connector
import time
import psutil
import hashlib
import time
import random
import threading
import requests
import paypalrestsdk




import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart


#hash salts
premd = "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"

postmd = "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"

presha = "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"
postsha = "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"


production = False


smtp_server = 'smtp.gmail.com'
smtp_port = 587
smtp_username = 'georgianbase2023@gmail.com'
smtp_password = ''


# Set up the ec_user content
from_address = 'georgianbase2023@gmail.com'



# paypalrestsdk.configure({
#     "mode": "live", # sandbox or live
#     "client_id": "",
#     "client_secret": ""

    
#     })


if production:

    server =  smtplib.SMTP(smtp_server, smtp_port)
    server.starttls()
    server.login(smtp_username, smtp_password)
app = Flask(__name__)


socketio = SocketIO(app)

# CREATE TABLE the_database(pir_nomeri BIGINT, gvari VARCHAR(32), saxeli VARCHAR(30), mama VARCHAR(30), sqesi VARCHAR(3), dabweli VARCHAR(10), qucha VARCHAR(76), reg VARCHAR(13)    );
# CREATE TABLE person_searches(id INTEGER PRIMARY KEY AUTOINCREMENT, payload VARCHAR(100), c_user INTEGER, ip VARCHAR(16), search_time  INTEGER);

# CREATE TABLE request_infos(request_infos_id INTEGER PRIMARY KEY AUTOINCREMENT, request_infos_ip VARCHAR(16), request_infos_header_info VARCHAR(1500), request_infos_request_name VARCHAR(50),request_infos_request_date VARCHAR(40), request_infos_request_time INTEGER, request_infos_the_search VARCHAR(70));  
# CREATE TABLE users(id INTEGER PRIMARY KEY AUTOINCREMENT, ip VARCHAR(16), mail VARCHAR(40), password VARCHAR(100), vcode MEDIUMINT , user_creation_time INTEGER, refstr VARCHAR(50) );
# CREATE TABLE saved_rows(row_id INTEGER PRIMARY KEY AUTOINCREMENT, saver_id INTEGER, piradobis_nomeri_id BIGINT);
# CREATE TABLE searches(search_id INTEGER PRIMARY KEY AUTOINCREMENT, searcher_ip VARCHAR(16));
# CREATE TABLE acc_upgrades(acc_upgrade_id INTEGER PRIMARY KEY AUTOINCREMENT, upgraded_acc_id INTEGER, acc_upgrade_time INTEGER, acc_upgrade_duration INTEGER ); 
# CREATE TABLE ref_invites( ref_invite_id  INTEGER PRIMARY KEY AUTOINCREMENT, ref_inviter_id INTEGER) ;
# CREATE TABLE login_attempts(id INTEGER PRIMARY KEY AUTOINCREMENT,mail VARCHAR(40),dro INT, ip VARCHAR(16));




enc_keys = {}
payment_ids = {}

host = "127.0.0.1"
user = "root"
passwd = ""
database = "geobase"


db = mysql.connector.connect(
    host=host,
    user=user,
    passwd = passwd,
    database= database
)


class sqlite3:
    def connect():
        # db = mysql.connector.connect(
        #     host=host,
        #     user=user,
        #     passwd = passwd,
        #     database= database
        # )
        return db





continuing_searches = {}
continuing_saved_searches = {}

locations = [
        "აბასთუმანი",
        "ახალციხე",
        "ბათუმი",
        "ბაკურიანი",
        "ბოლნისი",
        "ბორჯომი",
        "გონიო",
        "გორი",
        "გუდაური",
        "გურჯაანი",
        "დავით-გარეჯი",
        "ზესტაფონი",
        "ზუგდიდი",
        "თბილისი",
        "თელავი",
        "თიანეთი",
        "ლაგოდეხი",
        "ლანჩხუთი",
        "მანგლისი",
        "მარნეული",
        "მესტია",
        "მცხეთა",
        "ოზურგეთი",
        "ომალო",
        "ონი",
        "რუსთავი",
        "საგარეჯო",
        "სამტრედია",
        "საჩხერე",
        "სენაკი",
        "სიონი",
        "სიღნაღი",
        "სოხუმი",
        "სურამი",
        "ურეკი",
        "უშგული",
        "ფოთი",
        "ქობულეთი",
        "ქუთაისი",
        "შატილი",
        "შეკვეთილი",
        "შოვი",
        "ჩოხატაური",
        "ცხინვალი",
        "წინანდალი",
        "წყნეთი",
        "ჭიათურა",
        "ხარაგაული",
        "ხაშური",
        "ხობი"
    ]
locations_en = [
        "abastumani",
        "axalcixe",
        "batumi",
        "bakuriani",
        "bolnisi",
        "borjomi",
        "gonio",
        "gori",
        "gudauri",
        "gurjaani",
        "davit gareji",
        "zestafoni",
        "zugdidi",
        "tbilisi",
        "telavi",
        "tianeti",
        "lagodexi",
        "lancxuti",
        "manglisi",
        "marneuli",
        "mestia",
        "mcxeta",
        "ozurgeti",
        "omalo",
        "oni",
        "rustavi",
        "sagarejo",
        "samtredia",
        "sacxere",
        "senaki",
        "sioni",
        "sirnari",
        "soxumi",
        "surami",
        "ureki",
        "usguli",
        "foti",
        "qobuleti",
        "qutaisi",
        "satili",
        "sekvetili",
        "sovi",
        "coxatauri",
        "cxinvali",
        "winandali",
        "wyneti",
        "wiatura",
        "xaragauli",
        "xasuri",
        "xobi"


        ]

alt_names = [
    ['Giorgi', 'Goga', 'Gia', 'Gio'],
    ['Nino','Nini', 'Niniko', 'Ninutsa','Nina'],
    ['Davit', 'Dato', 'Daviti'],
    ['Sandro','Aleqsandre'],
    ['Ana', 'Anuka', 'Anano','Ani'],
    ['Levan', 'Leko', 'Levani'],
    ['Mariam', 'Mako', 'Marika'],
    ['Irakli', 'Irako', 'Iro','Ika','Irakla'],
    ['Salome', 'Sali', 'Saliko','Salo'],
    ['Kakha', 'Kako', 'Kakhi'],
    ['Natia', 'Nati', 'Nato'],
    ['Lasha', 'Lasho', 'Lashka'],
    ['Tamar', 'Tamari', 'Tamuna'],
    ['Vakhtang', 'Vako', 'Vakho'],
    ['Nana', 'Nanuka', 'Nani'],
    ['Keti', 'Kato', 'Keti'],
    ['Daviti', 'Dato', 'Davit'],
    ['Nuka', 'Nuki', 'Nukri'],
    ['Mari', 'Mariko', 'Marita'],
    ['Revaz', 'Rezo', 'Razik'],
    ['Nata', 'Nati', 'Natia'],
    ['Malkhaz', 'Mako', 'Malkhazi'],
    ['Tekla', 'Tako', 'Teko','Tiko', 'Tika', 'Tikoza'],
    ['Shalva', 'Shako', 'Shaliko'],
    ['Shorena', 'Shoka', 'Shoni'],
    ['Temur', 'Temo', 'Temo'],
    ['Tamari', 'Tamro', 'Tamaro'],
    ['Gvantsa', 'Gvanto', 'Gva'],
    ['Erekle', 'Reko', 'Erek'],
    ['Elene', 'Leko', 'Lena','Elena','Ele'],
    ['Nikoloz', 'Nika', 'Nikusha', 'Niko'],
    ['Ekaterine', 'Eka', 'Katia', 'Kato'],
    ['Shota', 'Shako', 'Shotaia'],
    ['Nargiz', 'Nara', 'Nargo'],
    ['Lado', 'Ladiko', 'Lasha'],
    ['Sophio', 'Sofiko', 'Sofi'],
    ['Zaza', 'Zazo', 'Zauri'],
    ['Lamara', 'Lami', 'Lamz'],
    ['Archil', 'Archo', 'Archi'],
    ['Eteri', 'Eto', 'Eteriko'],
    ['Zurab', 'Zura', 'Zuro'],
    ['Rusudan', 'Rusi', 'Rusiko'],
    ['Badri', 'Bado', 'Badocha'],
    ['Tsisana', 'Tsisa', 'Tsitsi'],
    ['Zviad', 'Zviadi', 'Zvi'],
    ['Elguja', 'Elguji', 'Elgo'],
    ['Gvantsa', 'Gva', 'Gviko'],
    ['Manana', 'Mano', 'Manoni'],
    ['Ucha', 'Uchiko', 'Uchu'],
    ['Lali', 'Laliko', 'Lala'],
    ['Guram', 'Gura', 'Guga'],
    # ['Ia', 'Ika', 'Iago'],
    # ['Tiko', 'Tika', 'Tikoza'],
    ['Ketino', 'Keto', 'Keti'],
    ['Leila', 'Leilo', 'Leiloza'],
    ['Gogi', 'Gogicha', 'Gogita'],
    ['Mzia', 'Mziako', 'Mzi'],
    ['Vaso', 'Vasiko', 'Vasoza'],
    ['Gaga', 'Gagusha', 'Gagiko'],
    ['Khatuna', 'Khati', 'Khato'],
    ['Sveta',"Svetlana"],
    ['Kote',"Konstantine"],
    ["Bidzina","Bidzo"],
    ["Qristine","Qristina"],
    ["Misha","Misho","Mishka","Mikheili","Mikheil","Mixeili","Mixeil"]
]


def ranstr(zoma,charls="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM1234567890"):
    pasuxi = ""
    chls = list(charls)
    for i in range(0,int(zoma)):
        pasuxi+= charls[random.randint(0,len(charls)-1)]
    return pasuxi

def auth(c_user,xs,tipi="cookie"):

    pasuxi = False
    if c_user != None and xs != None:
        db = sqlite3.connect()
        kurs = db.cursor()

        

        
        if tipi == "cookie":
            
            kurs.execute("SELECT * FROM users WHERE id = %(id)s",{"id" : int(c_user) })
            kursf= kurs.fetchone()
            if kursf != None:
                if kursf[3] == hashlib.sha256((presha + xs + postsha).encode("utf-8")).hexdigest():
                    if kursf[4] == 1:
                        pasuxi = True
                    elif kursf[4] != 1 and  int(kursf[5]) < (int(time.time()) - (10*60)):
                        pasuxi = "unverified_expired"
                    elif kursf[4] != 1 and  int(kursf[5]) > (int(time.time()) - (10*60)):
                        pasuxi = "unverified"
        elif tipi == "login":
            kurs.execute("SELECT * FROM users WHERE id = %(id)s",{"id" : c_user })
            if kursf != None:
                if kursf[3] == hashlib.sha256((presha + hashlib.md5((premd + xs + postmd).encode("utf-8")).hexdigest() + postsha).encode("utf-8")).hexdigest():
                    pasuxi = True
            

    return pasuxi
def premium(c_user,xs):
    db = sqlite3.connect()
    kurs = db.cursor()
    # kurs.execute("CREATE TABLE acc_upgrades(acc_upgrade_id INTEGER PRIMARY KEY AUTOINCREMENT, upgraded_acc_id INTEGER, acc_upgrade_time INTEGER, acc_upgrade_duration INTEGER, acc_upgrades_passtype VARCHAR(40)); ")
    if auth(c_user,xs) == True:
        kurs.execute("SELECT * FROM acc_upgrades WHERE   upgraded_acc_id = %(upgraded_acc_id)s AND  (acc_upgrade_time + acc_upgrade_duration ) > %(curr_time)s ;",{"upgraded_acc_id" : int(c_user), "curr_time" : int(time.time())})
        if kurs.fetchall() == []:
            return False
        else:
            return True
    else:
        return False

def root_proccess(markupi):
    qveda = markupi.split("""id="root">""")[1]
    mainspl = qveda.split("</div>")
    gverdi = ""
    for i in mainspl[:len(mainspl)-2]:
        gverdi+=i
    return gverdi

def reqapprove(request,url_name,payload={}):
    
    db = sqlite3.connect()
    ip = request.environ.get('HTTP_X_FORWARDED_FOR', request.remote_addr).replace("::ffff:","")
    header = str(request.headers)

    print("headers",request.headers.get("Content-Type"))
    if request.headers.get("Content-Type") !="application/x-www-form-urlencoded":
        if production:
                ipinfoio_url = f"https://ipinfo.io/{ip}/json"
                req = requests.get(ipinfoio_url)
                data = json.loads(req.text)
                regioni = data["country"]
                if regioni == "GE":
                    ip_gateway = True
                else:
                    ip_gateway = False
        else:
            ip_gateway = True
        if ip_gateway:
            print("ip addr",ip)
            kurs = db.cursor()
            kurs.execute("SELECT * FROM request_infos WHERE request_infos_ip = %(aipi)s AND request_infos_request_time > %(mindro)s",{"aipi" : str(ip),"mindro" : int(time.time()) - 3600 })
            
            kursf = kurs.fetchall()
            # kurs.execute("CREATE TABLE request_infos(request_infos_id INTEGER PRIMARY KEY AUTOINCREMENT, request_infos_ip VARCHAR(20), request_infos_header_info VARCHAR(1500), request_infos_request_name VARCHAR(50),request_infos_request_date VARCHAR(40), request_infos_payload VARCHAR(100), request_infos_request_time INTEGER, request_infos_the_search VARCHAR(70));  ")

            # kurs.execute("INSERT INTO request_infos(request_infos_ip  ,request_infos_header_info    ,request_infos_request_name   ,request_infos_request_date   ,       request_infos_payload , request_infos_request_time  ) VALUES(%s,%s,%s,%s,%s,%s)",(ip,header,url_name,str(datetime.datetime.now()),json.dumps(payload),int(time.time()) ))
            kurs.execute("INSERT INTO request_infos(request_infos_ip ,request_infos_request_name   ,request_infos_request_date    , request_infos_request_time  ) VALUES(%s,%s,%s,%s)",(ip,url_name,str(datetime.datetime.now()),int(time.time()) ))
            
            
            
            # CREATE TABLE person_searches(id INTEGER PRIMARY KEY AUTO_INCREMENT, payload VARCHAR(100), c_user INTEGER, ip VARCHAR(16), search_time INTEGER);
            # maxnum = 50
            maxnum = 5000000000
            
            if len(kursf) < maxnum:
                
                db.commit()
                resbool =  True
            else:
                resbool =  "too much requets"
            return {"resbool" : resbool, "ip" : ip,"kurs" : kurs}
        else:
            return {"resbool" : True, "ip" : ip,"kurs" : db.cursor()}





@socketio.on("message")
def message(msg):
    print(request.headers)
    print("recieved!",msg,request.remote_addr)


@socketio.on("premium_referal_invite_broadcastroom_join")
def premium_referal_invite_broadcastroom_join(data):
    reqap = reqapprove(request,"premium_referal_invite_broadcastroom_join")
    if reqap["resbool"] == True:
        c_user = data["c_user"]
        xs = data["xs"]
        authi = auth(c_user,xs)
        if authi == True:


            print("success_joinr")
            join_room("premium_referal_invite_broadcastroom_" + str(c_user))

            
            
        


@socketio.on("invite")
def invite(data):
    ip = request.environ.get('HTTP_X_FORWARDED_FOR', request.remote_addr).replace("::ffff:","")
    
    db = sqlite3.connect()
    kurs = db.cursor()

    refer_user_id = int(data["referer_user_id"])

    kurs.execute("SELECT * FROM request_infos WHERE request_infos_ip = %(request_infos_ip)s",{"request_infos_ip" : ip})
    
    kurs_request_infos = kurs.fetchall()
    
    reqap = reqapprove(request,"invite")
    if reqap["resbool"] == True :

        if production:
            kurs_request_infos_gateway = len(kurs_request_infos) == 0
        else:
            kurs_request_infos_gateway = True
        if kurs_request_infos_gateway:
            kurs.execute("SELECT * FROM ref_invites WHERE ref_inviter_id = %(ref_inviter_id)s",{"ref_inviter_id" : int(refer_user_id)})

            kursf_ref_invites = kurs.fetchall()
            required_invites_count = 40
            if len(kursf_ref_invites) < required_invites_count:
                
                # kurs.execute("CREATE TABLE ref_invites( ref_invite_id  INTEGER PRIMARY KEY AUTOINCREMENT, ref_inviter_id INTEGER, ref_invited_ip  VARCHAR(30) , ref_invite_status VARCHAR(2)) ;")
                            
                kurs.execute("INSERT INTO ref_invites(ref_inviter_id) VALUES(%s)",(int(refer_user_id),))


                if len(kursf_ref_invites) == (required_invites_count - 1):
                    # pass #premiumis insert 1 tvit
                    acc_upgrade_duration = int(time.time()) + (84600 * 30)
                    kurs.execute("INSERT INTO acc_upgrades(upgraded_acc_id,acc_upgrade_time,acc_upgrade_duration) VALUES(%s,%s,%s);",(int(refer_user_id), int(time.time()), int(acc_upgrade_duration)  ) )
                    kurs.execute("DELETE FROM ref_invites WHERE ref_inviter_id = %(ref_inviter_id)s",{"ref_inviter_id" : refer_user_id })
                    

                db.commit()
                msg = json.dumps({"type" : "premium_referal_invite_countdown_increase"})
                
                send(msg,broadcast=True,room="premium_referal_invite_broadcastroom_" + str(refer_user_id))
            
        send("redirect",broadcast=False)



@app.errorhandler(404)
def page_notfound(e):
    print("cont",request.headers.get("Content-Type"))

    reqap = reqapprove(request,"/")
    if reqap["resbool"] == True:
        # if request.args.get("type")  =="dynamic":
            
            # return root_proccess(render_template("index.html"))
        # else:
            # return render_template("index.html",bg=Markup(render_template("bg.html")))
        authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
        c_user = request.cookies.get("c_user")
        xs = request.cookies.get("xs")
        
        if authi == True:
            loggedin_bool = "true"
            db = sqlite3.connect()
            kurs = db.cursor()
            kurs.execute("SELECT * FROM users WHERE id = %(id)s",{"id" : int(request.cookies.get("c_user"))})
            kursf = kurs.fetchone()
            if premium(c_user,xs) == True:
                profile_info_arr_bgcolor = "#cab333"
            else:
                profile_info_arr_bgcolor = "white"
            navbar_authed = Markup(render_template("navbar_authed.html",mail=kursf[2], profile_info_arr_bgcolor=profile_info_arr_bgcolor))
            unauthed_reglog = ""
            unauthed_reglog_mob = ""
        else:
            loggedin_bool = "false"
            navbar_authed = ""
            

            unauthed_reglog = Markup("""
                    <h3 id = "registracia" class = "account_access_label">რეგისტრაცია</h3>
                    <h3 id = "avtorizacia" class = "account_access_label">ავტორიზაცია</h3>
                """)
            unauthed_reglog_mob = Markup("""
            <div id = "mobile_navbar_btn">
                <svg viewBox="0 0 100 80" width="40" height="40">
                    <rect width="100" height="20" fill = "white"></rect>
                    <rect y="30" width="100" fill="white" height="20"></rect>
                    <rect y="60" width="100" fill = "white" height="20"></rect>
                </svg>
            </div> 
                <div id = "mobile_navbar">
                    <div id = "mobile_navbar_cancell_btn"></div>
                    <h3 class = "mob_account_access_label" id ="mob_registracia">რეგისტრაცია</h3>
                    <h3 class = "mob_account_access_label" id = "mob_avtorizacia">ავტორიზაცია</h3>
                    
                </div>
            """)
        
        return render_template("pagenotfound.html",authed=str(authi),premium=str(premium(c_user,xs)),bg=Markup(render_template("bg.html")) , navbar_authed=navbar_authed,unauthed_reglog=unauthed_reglog,unauthed_reglog_mob=unauthed_reglog_mob ,loggedin_bool=loggedin_bool)
        
    else:
        return reqap["resbool"]



@app.route("/pc_stat")
def pc_stat():
    return str(psutil.sensors_battery()[0]) + "%"

@app.route("/")
def homepage():

    reqap = reqapprove(request,"/")
    if reqap["resbool"] == True:
        # if request.args.get("type")  =="dynamic":
            
            # return root_proccess(render_template("index.html"))
        # else:
            # return render_template("index.html",bg=Markup(render_template("bg.html")))
        authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
        c_user = request.cookies.get("c_user")
        xs = request.cookies.get("xs")
        
        if authi == True:
            loggedin_bool = "true"
            db = sqlite3.connect()
            kurs = db.cursor()
            kurs.execute("SELECT * FROM users WHERE id = %(id)s",{"id" : int(request.cookies.get("c_user"))})
            kursf = kurs.fetchone()
            if premium(c_user,xs) == True:
                profile_info_arr_bgcolor = "#cab333"
            else:
                profile_info_arr_bgcolor = "white"
            navbar_authed = Markup(render_template("navbar_authed.html",mail=kursf[2], profile_info_arr_bgcolor=profile_info_arr_bgcolor))
            unauthed_reglog = ""
            unauthed_reglog_mob = ""
        else:
            loggedin_bool = "false"
            navbar_authed = ""
            

            unauthed_reglog = Markup("""
                    <h3 id = "registracia" class = "account_access_label">რეგისტრაცია</h3>
                    <h3 id = "avtorizacia" class = "account_access_label">ავტორიზაცია</h3>
                """)
            unauthed_reglog_mob = Markup("""
            <div id = "mobile_navbar_btn">
                <svg viewBox="0 0 100 80" width="40" height="40">
                    <rect width="100" height="20" fill = "white"></rect>
                    <rect y="30" width="100" fill="white" height="20"></rect>
                    <rect y="60" width="100" fill = "white" height="20"></rect>
                </svg>
            </div> 
                <div id = "mobile_navbar">
                    <div id = "mobile_navbar_cancell_btn"></div>
                    <h3 class = "mob_account_access_label" id ="mob_registracia">რეგისტრაცია</h3>
                    <h3 class = "mob_account_access_label" id = "mob_avtorizacia">ავტორიზაცია</h3>
                    
                </div>
            """)
        if production:
            ipinfoio_url = f"https://ipinfo.io/{reqap['ip']}/json"
            req = requests.get(ipinfoio_url)
            data = json.loads(req.text)
            regioni = data["city"]
        else:
            regioni = "tbilisi"
        if production:
            saxeli_value = ""
            gvari_value = ""
            
        else:
            saxeli_value = "ნიკა"
            gvari_value = "კაპანაძე"
        
        redirect_act_reqArg = request.args.get("redirect_act")
        
        return render_template("index.html",redirect_act_reqArg=redirect_act_reqArg,authed=str(authi),premium=str(premium(c_user,xs)),bg=Markup(render_template("bg.html")),regioni=regioni.capitalize(),saxeli_value=saxeli_value,gvari_value=gvari_value , navbar_authed=navbar_authed,unauthed_reglog=unauthed_reglog,unauthed_reglog_mob=unauthed_reglog_mob ,loggedin_bool=loggedin_bool)
        
    else:
        return reqap["resbool"]
    
@app.route('/payment', methods=['GET','POST'])
def payment():
    
    # fasi = 4.99
    authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
    c_user = request.cookies.get("c_user")
    xs = request.cookies.get("xs")
    if authi == True:
        db = sqlite3.connect()
        kurs = db.cursor()
        if premium(c_user,xs) != True:
            if production:
                fasi = int((int(request.form["raodenoba"]) * 4.99) * 100) /100
            
            else:
                fasi = 0.01
                fasi = 0.01 * int(request.form["raodenoba"])
                
            print(fasi)
            raodenoba = 1
            # raodenoba = request.form["raodenoba"]
            print("payment POST",raodenoba)
            payment = paypalrestsdk.Payment({
                "intent": "sale",
                "payer": {
                    "payment_method": "paypal"},
                "redirect_urls": {
                    # "return_url": "http://localhost:5000/payment/execute",
                    # "cancel_url": "http://localhost:5000/"},
                    "return_url": "/payment/execute",
                    "cancel_url": "/"},
                "transactions": [{
                    "item_list": {
                        "items": [{
                            "name": "Premium",
                            "sku": "12345",
                            "price": str(fasi),
                            "currency": "USD",
                            "quantity": 1 }]},
                    "amount": {
                        "total": str(fasi),
                        "currency": "USD"},
                    "description": "This is the payment transaction description."}]})

            if payment.create():
                print('payment success')
            else:
                print(payment.error)
            payment_ids[str(payment.id)]  = {"c_user" : c_user, "xs" : xs, "raodenoba" : str(request.form["raodenoba"])}
            return jsonify({'paymentID' : payment.id})

@app.route('/execute', methods=['GET','POST'])
def execute():
    success = False
    authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
    myData = payment_ids[str(request.form['paymentID'])]
    c_user = request.cookies.get("c_user")
    xs = request.cookies.get("xs")

    if authi == True and myData["c_user"] == c_user and myData["xs"] == xs:
        payment = paypalrestsdk.Payment.find(request.form['paymentID'])
        print("executing")
        payment_response = payment.execute({'payer_id' : request.form['payerID']})
        if payment_response:
            print('success',payment_response,type(payment_response))
            c_user = request.cookies.get("c_user")
            xs = request.cookies.get("xs")
            db = sqlite3.connect()
            kurs = db.cursor()
            
            # kurs.execute("CREATE TABLE acc_upgrades(acc_upgrade_id INTEGER PRIMARY KEY AUTOINCREMENT, upgraded_acc_id INTEGER, acc_upgrade_time INTEGER, acc_upgrade_duration INTEGER, acc_upgrades_passtype VARCHAR(40)); ")
            #warmatebit gadaixada
            # db = mysql.connector.connect(
            
            #             host=sql_host,
            #             user=sql_user,
            #             passwd=sql_passwd,
            #             database=sql_db
        

            # )
            # kurs = db.cursor()

            # kurs.execute("UPDATE users SET premium_time = '"+ str(int(time.time())) +"' WHERE username = '"+c_user+"';")

            # kurs.execute("ALTER TABLE "+c_user+"_tab MODIFY text VARCHAR(5000);")


            #kurs.execute("ALTER TABLE " +c_user + "_tab DROP text")

            #kurs.execute("ALTER TABLE " +c_user + "_tab ADD text VARCHAR(5000) ")

            # db.commit()

            acc_upgrade_duration = int(time.time()) +( int(myData["raodenoba"]) * 84600 * 30)
            kurs.execute("INSERT INTO acc_upgrades(upgraded_acc_id,acc_upgrade_time,acc_upgrade_duration) VALUES(?,?,?);",(int(c_user), int(time.time()), int(acc_upgrade_duration)  ) )
            db.commit()
            success = True
            
        else:
            print(payment.error)

        return jsonify({'success' : success})


@app.route("/login",methods=["GET","POST"])
def login():
    reqap = reqapprove(request,"/login")
    if reqap["resbool"] == True:
        authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))

        if authi != True:
            if request.method == "GET":
                redirecti = request.args.get('redirect')
                return render_template("login.html",redirecti=redirecti,bg=Markup(render_template("bg.html")),navbar=Markup(render_template("navbar.html")) )
            elif request.method == "POST":
                db = sqlite3.connect()
                # CREATE TABLE login_attempts(id INTEGER PRIMARY KEY AUTO_INCREMENT,mail VARCHAR(40),dro INT);
                kurs = db.cursor()
                mail = request.form["mail_input"]
                xs = hashlib.md5((premd+request.form["pass_input"] + postmd).encode('utf-8')).hexdigest()
                
                kurs.execute("SELECT * FROM users WHERE mail =  %(mail)s ;",{"mail" : mail})
                # kurs.execute("SELECT * FROM users WHERE mail = '"+ mail +"' AND password = '"+ str(hashlib.sha256(xs.encode("utf-8")).hexdigest()) +"'")
                # kurs.execute("SELECT * FROM users WHERE mail = :mail AND password = :xs",{"mail" :mail,"xs" : hashlib.sha256(xs.encode("utf-8")).hexdigest() })
                kursf = kurs.fetchone()

                resbool = "false"
                msg = "არასწორი მონაცემები"
                c_user = ""
                enc_key = ""
                enc_keystr = ""


                if kursf != None:
                    kurs.execute("SELECT * FROM login_attempts WHERE mail = %(mail)s  AND dro > %(dro)s;",{"mail" : mail,"dro" : ( int(time.time()) -  (3600 * 12)  ) })
                    kurs_atts = kurs.fetchall()
                    if len(kurs_atts) < 10:
                        if kursf[3] == str(hashlib.sha256((presha + xs + postsha).encode("utf-8")).hexdigest()):
                            c_user = str(kursf[0])
                            msg = ""
                            resbool = "true"
                            kurs.execute("DELETE FROM login_attempts WHERE mail = %(mail)s AND ip = %(ip)s",{"mail" : mail, "ip" :reqap["ip"] })
                            db.commit()
                            # enc_key = Fernet.generate_key()
                            # enc_keys[c_user] = enc_key
                            # enc_keystr = enc_key.decode("utf-8")
                        else:

                            kurs.execute("INSERT INTO login_attempts(mail,dro,ip) VALUES(%s,%s,%s)",(mail,int(time.time()), reqap["ip"]))
                            db.commit()
                    else:
                        c_user = kursf[0]
                        msg = "ძალიან ბევრი მცდელობა, გთხოვთ დაიცადოთ"
                        resbool = "false"

                
                return json.dumps({"resbool" : resbool,"c_user" : c_user,"xs" : xs,"msg" : msg
                                #    ,"enc_key" :enc_keystr
                                    })


@app.route("/resend_vcode",methods=["GET","POST"])
def resend_vcode():
    c_user = request.cookies.get("c_user")
    xs = request.cookies.get("xs")
    if c_user != None and xs != None:
        authi = auth(c_user,xs)
        # if True:
        if authi == "unverified":
            message = MIMEMultipart()
            message['From'] = from_address
            message['To'] = ""
            vcode = random.randint(100000,999999)
            db = sqlite3.connect()
            kurs = db.cursor()
            kurs.execute("SELECT * FROM users WHERE id = %(c_user)s ; ",{"c_user" : int(c_user)})
            kursf = kurs.fetchone()
            if kursf != None:
                mail = kursf[2]
                kurs.execute("UPDATE users SET vcode = %(vcode)s WHERE  id =  %(c_user)s;",{"vcode" : vcode,"c_user" : c_user})
                mailsend(mail,vcode)
                db.commit()
                # threading.Thread(target=mailsend,args=(mail,vcode)).start()
                return "success"


@app.route("/upgrade_account/<tipi>/<passi>")
def upgrade_account(tipi,passi): 
    #tipi - jerjerobit mxolod valuebi : "buy" da "referal"
    #passi - premium an tu cifri dinamikuri ogond auclieblad 3is jeradi
    reqap = reqapprove(request,"/upgrade_account")
    if reqap["resbool"] == True:
        if request.method == "GET":
            authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
            
            if authi == True:
                c_user = request.cookies.get("c_user")
                xs = request.cookies.get("xs")
                if tipi == "buy":
                    if passi == "premium":
                        if request.cookies.get("c_user") != None or request.cookies.get("xs") != None:
                            
                            if authi == True:
                                db = sqlite3.connect()
                                kurs = db.cursor()
                                kurs.execute("SELECT * FROM users WHERE id = %(id)s",{"id" : int(request.cookies.get("c_user"))})
                                kursf = kurs.fetchone()
                                navbar_authed = Markup(render_template("navbar_authed.html",mail=kursf[2]))


                                return render_template("buy_premium.html",bg=Markup(render_template("bg.html")),navbar_authed=navbar_authed)
                elif tipi == "referal":
                    if passi == "premium":

                        # if premium(c_user,xs) != True:
                        db = sqlite3.connect()
                        kurs = db.cursor()
                        kurs.execute("SELECT * FROM users WHERE id = %(id)s",{"id" : int(request.cookies.get("c_user"))})
                        kursf_u = kurs.fetchone()
                        refstr = kursf_u[6]
                        if premium(c_user,xs) == True:
                            profile_info_arr_bgcolor = "#cab333"
                        else:
                            profile_info_arr_bgcolor = "white"
                        navbar_authed = Markup(render_template("navbar_authed.html",mail=kursf_u[2],profile_info_arr_bgcolor=profile_info_arr_bgcolor))

                        # kurs.execute("CREATE TABLE ref_invites( ref_invite_id  INTEGER PRIMARY KEY AUTOINCREMENT, ref_inviter_id INTEGER, ref_invited_ip  VARCHAR(30) , ref_invite_status VARCHAR(2)) ;")
                        if production:
                            domeni = "georgianbase.pagekite.me"
                        else:
                            domeni = "localhost:5000"
                        prem = premium(c_user,xs)
                        if  prem != True:
                            
                            

                            kurs.execute("SELECT ref_invite_id, ref_inviter_id FROM ref_invites WHERE ref_inviter_id = %(ref_inviter_id)s  ;",{"ref_inviter_id" : int(c_user)})

                            kursf_refinvites = kurs.fetchall()

                            kursf_refinvites_count = len(kursf_refinvites)

                            

                            # invite_linki = f"{domeni}/invite/{str(c_user)}/{refstr}"
                            invite_linki = f"http://{domeni}/invite/{refstr}"
                        

                        else:
                            kursf_refinvites_count = 0
                            invite_linki = ""

                        if kursf_refinvites_count >= 40 or prem == True:
                            referal_premium_maindiv = Markup(render_template("referal_premium_donemaindiv.html"))
                        else:
                            referal_premium_maindiv = Markup(render_template("referal_premium_maindiv.html",invite_linki=invite_linki,kursf_refinvites_count=str(kursf_refinvites_count),domeni=domeni))
                            
                        

                        

                        navbar = Markup(render_template("navbar.html"))



                        

                        
                        return render_template("referal_premium.html",bg=Markup(render_template("bg.html")),navbar_authed=navbar_authed,navbar=navbar
                                            ,kursf_refinvites_count=kursf_refinvites_count,referal_premium_maindiv=referal_premium_maindiv,profile_info_arr_bgcolor=profile_info_arr_bgcolor)


            
            else:
                print("redr")
                return redirect(f"/login?redirect=/upgrade_account/{tipi}/{passi}")
        
    
@app.route("/invite/<refstr>")
def invite(refstr):
    print(request.headers.get("Host"))
    sareturno = "<center><h1>IP BLOCKED</h1></center>"
    db = sqlite3.connect()
    kurs = db.cursor()

    kurs.execute("SELECT * FROM users WHERE refstr = %(refstr)s",{"refstr" : refstr})
    kursf = kurs.fetchone()
    refer_user_id = kursf[0]


    kurs.execute("SELECT * FROM ref_invites WHERE ref_inviter_id = %(ref_inviter_id)s",{"ref_inviter_id" : int(refer_user_id)})

    kursf_ref_invites = kurs.fetchall()

    if len(kursf_ref_invites) < 40:

        ip = request.environ.get('HTTP_X_FORWARDED_FOR', request.remote_addr).replace("::ffff:","")
    
        
        
        # reqap = reqapprove(request,"/invite")
        # if reqap["resbool"] == True:
        # kursf=  kurs.fetchall()

        # if len(kursf) == 0:
        if True:
            # kurs.execute("CREATE TABLE ref_invites( ref_invite_id  INTEGER PRIMARY KEY AUTOINCREMENT, ref_inviter_id INTEGER, ref_invited_ip  VARCHAR(30) , ref_invite_status VARCHAR(2)) ;")

            # kurs.execute("SELECT ref_invite_id, ref_inviter_id, ref_invited_ip FROM ref_invites WHERE ref_inviter_id = %(ref_inviter_id)s  ;",{"ref_inviter_id" : int(c_user)})
            
            
            # kurs.execute("INSERT INTO ref_invites(ref_inviter_id) VALUES(%s); ",( int(refer_user_id) ,  ))
            # db.commit()

            # socketio.emit(`"invite`",data={"baro" : "lasha"})

            # sareturno=  redirect("/")

            # sareturno = redirect("/")
            sareturno = """
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Document</title>
                </head>
                <body>
                    <script src = "/static/socket.io.js"></script>
                    <script>
                        var soketi = io();
                        soketi.addEventListener("connect",function(){
                            soketi.emit("invite",data={'referer_user_id' : '""" + str(refer_user_id) +"""'})
                        })
                        soketi.addEventListener("message",function(){
                            window.location.href = "/";
                        })
                        
                    </script>
                </body>
                </html>
            """
    else:
        sareturno = redirect("/")
    return sareturno

        


@app.route("/saved_searches")
def saved_searches():
    reqap = reqapprove(request,"/saved_searches")
    if  request.args.get("continuing") != "true":
        gateway_bool = reqap["resbool"] 
    else:
        gateway_bool = True
    if gateway_bool == True:
        if request.method == "GET":
            if request.cookies.get("c_user") != None or request.cookies.get("xs") != None:
                authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
                c_user = request.cookies.get("c_user")
                xs = request.cookies.get("xs")
                if authi == True:
                    db = sqlite3.connect()
                    kurs = db.cursor()
                    kurs.execute("SELECT * FROM users WHERE id = %(id)s",{"id" : int(request.cookies.get("c_user"))})
                    kursf = kurs.fetchone()
                    if premium(c_user,xs) == True:
                        profile_info_arr_bgcolor = "#cab333"
                    else:
                        profile_info_arr_bgcolor = "white"
                    navbar_authed = Markup(render_template("navbar_authed.html",mail=kursf[2], profile_info_arr_bgcolor=profile_info_arr_bgcolor  ))

                    # kurs.execute("SELECT pir_nomeri , gvari , saxeli , mama , sqesi , dabweli , qucha , reg                                  FROM saved_rows INNER JOIN database ON piradobis_nomeri_id = pir_nomeri WHERE saver_id = :c_user",{"c_user" : int(c_user)})
                    # kursf = kurs.fetchall()
                    results = ""
                    geotve = ["იანვარი","თებერვალი","მარტი","აპრილი","მაისი","ივნისი","ივლისი","აგვისტო","სექტემბერი","ოქტომბერი","ნოემბერი","დეკემბერი"]
                    data = {}
                    kurs.execute("SELECT piradobis_nomeri_id,row_id  FROM saved_rows  WHERE saver_id = %(c_user)s",{"c_user" : int(c_user)})
                    lisf = kurs.fetchall()
                    if lisf != []:
                        lis = np.array(lisf)
                        ls = tuple(lis[:,0].reshape((1,len(lis[:,0])))[0])


                        if len(ls) == 1:
                            ls = "(" + str(ls[0]) + ")"
                        

                        print(ls)
                        

                        
                        

                        if request.args.get("continuing") != "true": #tu chveulebriv

                            
                            # kurs.execute("SELECT pir_nomeri , gvari , saxeli , mama , sqesi , dabweli , qucha , reg FROM the_database WHERE pir_nomeri IN "+ str(ls) +"  ;")
                            kurs.execute("SELECT the_database.pir_nomeri , the_database.gvari , the_database.saxeli , the_database.mama , the_database.sqesi , the_database.dabweli , the_database.qucha , the_database.reg FROM saved_rows LEFT JOIN the_database ON the_database.pir_nomeri = saved_rows.piradobis_nomeri_id  WHERE saved_rows.saver_id = %(saver_id)s;  ",{"saver_id" : int(c_user)})

                            kursf = np.array(kurs.fetchall())

                            # row_primids = np.array()
                            
                            new_rows = np.array([])

                            for i in kursf:
                                # print(i[0])
                                indx = np.where(lis[:,0] == int(i[0]))
                                mwkrivis_idi = lis[indx,1]
                                # print("nhn",indx," ||| ")
                                sapendi = np.append(i,mwkrivis_idi)
                                # print("yh",i)

                                new_rows = np.append(new_rows,sapendi)
                            
                            new_rows = new_rows.reshape((  int(len(new_rows) / 9 ) , 9   ))
                            
                            searchtoken = c_user + ranstr(80)

                            # if request.args.get("reversed") == "true":
                            #     df = new_rows[np.argsort(new_rows[:,8].astype("int64") )[::] ]
                            # else:
                            #     df = new_rows[np.argsort(new_rows[:,8].astype("int64") )[::-1] ]
                            df = new_rows[np.argsort(new_rows[:,8].astype("int64") )[::-1] ]
                            continuing_saved_searches[searchtoken] = {"df" : df,"creation_time" : int(time.time())}

                            if request.args.get("reversed") == "true":
                                datafreimi = df[::-1]
                            else:
                                datafreimi = df

                            df = datafreimi[:10]
                            ixi = 0
                        else: # tu grdzeldebadi
                            searchtoken = request.args.get("searchtoken")

                            searchfromi = int(request.args.get("searchfrom"))

                            searchto = searchfromi + 10

                            ixi = searchfromi

                            if request.args.get("reversed") == "true":
                                datafreimi = continuing_saved_searches[searchtoken]["df"][::-1]
                            else:
                                datafreimi =   continuing_saved_searches[searchtoken]["df"]
                             
                            df = datafreimi[searchfromi:searchto]
                            # time.sleep(310000)l

                        # print("<new_rows>")
                        # for i in new_rows:
                            # print(i)
                        
                        
                        for i in df:
                            # try:
                            if True:
                                if True:
                                # if(  saxeli.lower() == i[2].lower() and (gvari.lower() == i[1].lower() or alt_gvari.lower() == i[1].lower() )    ):
                                    
                                    
                                    if str(i[0]) != "None":
                                        ixi+=1

                                        piradobis_nomeri = str(i[0]).replace(".0","")
                                        # print("found one : ",i)
                                        
                                        saxeli = i[2]
                                        gvari = i[1]
                                        
                                        if str(i[7]) != "None":
                                            regioni = i[7]
                                        else:
                                            regioni = "უცნობი"
                                        if str(i[6]) != "None":
                                            sacxovrebeli_qucha = i[6]
                                        else:
                                            sacxovrebeli_qucha = "უცნობი"

                                        if str(i[5]) != "None":
                                            dab_tarigi = str(i[5])

                                            ax_weli = int(str(datetime.datetime.now()).split("-")[0])
                                            ax_tve_i = int(str(datetime.datetime.now()).split("-")[1])
                                            ax_ricxvi_i = int(str(datetime.datetime.now()).split("-")[2].split()[0])
                                            weli = int(dab_tarigi.split(".")[2])


                                            ricxvi = int(dab_tarigi.split(".")[0])
                                            tve_i = int((dab_tarigi.split(".")[1]))
                                            tve = geotve[tve_i-1]
                                            wsxvaoba = str(ax_weli-weli)
                                            dabadebis_tarigi = f"{weli} წელი {ricxvi} {tve}"
                                            asaki = str(int((float(ax_weli) + float(ax_tve_i/12) + float(ax_ricxvi_i/365)) - ((float(weli))+ float(tve_i/12) + float(ricxvi/365))))
                                        
                                        else:
                                            asaki = "უცნობი"
                                            dabadebis_tarigi = "უცნობი"
                                        



                                        data[piradobis_nomeri] = {} #saxeligvari , sqesi, dabadeba, asaki, mama, sacxovrebeli qucha, regioni
                                        data[piradobis_nomeri]["saxeligvari"] = saxeli + " " + gvari
                                        if str(i[4]) != "None":
                                            if int(float(str(i[4]))) == 1:
                                                sqesi = "მამრობითი"
                                            elif int(float(str(i[4]))) == 2:
                                                sqesi = "მდედრობითი"
                                            
                                        else:
                                            sqesi = "უცნობი"

                                        if str(i[3]) != "None":
                                            mama = i[3] + " " + gvari
                                        else:
                                            mama = "უცნობი"
                                        data[piradobis_nomeri]["dabadebis_tarigi"] = dabadebis_tarigi
                                        data[piradobis_nomeri]["asaki"] = asaki
                                        data[piradobis_nomeri]["mama"] = mama
                                        data[piradobis_nomeri]["sacxovrebeli_qucha"] = sacxovrebeli_qucha
                                        data[piradobis_nomeri]["regioni"] = regioni
                                        data[piradobis_nomeri]["sqesi"] = sqesi




                                        data[piradobis_nomeri]["saved_bool"] = "true"
                                        # if authi == True:
                                        #     if i[8] == None:
                                        #         data[piradobis_nomeri]["saved_bool"] = "false"
                                        #     else:
                                        #         data[piradobis_nomeri]["saved_bool"] = "true"

                                        
                                        
                                        
                                        # <div id = "result_row_piradoba_{piradobis_nomeri}" class = " result_row_child">{str(i[8])}</div>
                                        # continuing_saved_searches[searchtoken]["df"]

                                        if datafreimi[::-1][0,0] == i[0]:
                                            last_row_bool = "true"
                                        else:
                                            last_row_bool = "false"

                                        
                                        if ( ("iphone"  in request.headers.get("User-Agent").lower()) or ("android"   in request.headers.get("User-Agent").lower() ) or ("blackberry"  in request.headers.get("User-Agent").lower() ) ):
                                            results+= f""" 
                                                <div last_row = "{last_row_bool}" id = "result_row_{piradobis_nomeri}" class = "result_row result_row_{str(ixi)}">

                                                    <div class = "upper_result_row">
                                                        <div id = "result_row_piradoba_{piradobis_nomeri}" class = "result_row_piradoba result_row_child">🆔{piradobis_nomeri}</div>
                                                        <div id = "result_row_regioni_{piradobis_nomeri}" class = "result_row_regioni result_row_child">📍{regioni}</div>
                                                        <div id = "result_row_asaki_{piradobis_nomeri}" class = "result_row_asaki  result_row_child">🎂{asaki}</div>
                                                    </div>

                                                    <div class = "lower_result_row">
                                                        <div id = "result_row_asaki_{piradobis_nomeri}" class = "result_row_saxeligvari  result_row_child">💳{saxeli} {gvari}</div>
                                                        <div id = "result_row_morebtn_{piradobis_nomeri}" piradobis_nomeri = "{piradobis_nomeri}" class = "result_row_morebtn  result_row_child">მეტი</div>
                                                    </div>

                                                </div>   """
                                             
                                        else:
                                            results+= f""" 
                                            <div last_row = "{last_row_bool}" id = "result_row_{piradobis_nomeri}" class = "result_row result_row_{str(ixi)}">

                                                
                                                <div id = "result_row_piradoba_{piradobis_nomeri}" class = "result_row_piradoba result_row_child">🆔{piradobis_nomeri}</div>
                                                <div id = "result_row_regioni_{piradobis_nomeri}" class = "result_row_regioni result_row_child">📍{regioni}</div>
                                                <div id = "result_row_asaki_{piradobis_nomeri}" class = "result_row_asaki  result_row_child">🎂{asaki}</div>
                                                <div id = "result_row_asaki_{piradobis_nomeri}" class = "result_row_saxeligvari  result_row_child">💳{saxeli} {gvari}</div>
                                                
                                                <div id = "result_row_morebtn_{piradobis_nomeri}" piradobis_nomeri = "{piradobis_nomeri}" class = "result_row_morebtn  result_row_child">მეტი</div>
                                                

                                            </div>   """
                                            
                            # except Exception as e:
                                # print("er",e)
                    else:
                        searchtoken = c_user + ranstr(80)
                        results = Markup("""
                            
                            <span id = "no_saved_persons_heading">თქვენ არ გყავთ არცერთი პიროვნება შენახული</span>

                            <div id = "modzebna_redirect">მოძებნა</div>

                        """)
                    if request.args.get("continuing") != "true":
                        return render_template("saved_searches.html",searchtoken=searchtoken,bg=Markup(render_template("bg.html")),data=Markup(json.dumps(data)),navbar=Markup(render_template("navbar.html")),navbar_authed=navbar_authed,results=Markup(results))
                    else:
                        return json.dumps([results,data])
@app.route("/save_search",methods=["POST","DELETE"])
def save_search():
    reqap = reqapprove(request,"/save_search")
    if reqap["resbool"] == True:
        # if request.method == "GET":

        if request.cookies.get("c_user") != None or request.cookies.get("xs") != None:

            c_user = request.cookies.get("c_user")
            xs = request.cookies.get("xs")

            authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
            c_user = request.cookies.get("c_user")
            xs = request.cookies.get("xs")
            if authi == True:
                db = sqlite3.connect()
                kurs = db.cursor()

                piradobis_nomeri = int(request.form["piradobis_nomeri"])
                if request.method == "POST":
                    kurs.execute("SELECT * FROM saved_rows WHERE saver_id = %(saver_id)s AND piradobis_nomeri_id= %(piradobis_nomeri)s;",{"saver_id" : int(request.cookies.get("c_user")), "piradobis_nomeri" : piradobis_nomeri})
                    
                    kursf = kurs.fetchall()


                    if len(kursf) == 0:   
                        kurs.execute("INSERT INTO saved_rows(saver_id,piradobis_nomeri_id) VALUES(%s,%s);",(c_user , piradobis_nomeri ))
                        db.commit()
                        return "success"
                if request.method == "DELETE":
                    kurs.execute("DELETE FROM saved_rows WHERE piradobis_nomeri_id = %(piradobis_nomeri)s and saver_id = %(saver_id)s;",{"piradobis_nomeri" : piradobis_nomeri,"saver_id" :int(request.cookies.get("c_user")) })
                    db.commit()

                    return "success"




@app.route("/confirmation",methods=["GET","POST"])
def confirmation():
    reqap = reqapprove(request,"/confirmation")
    print(reqap)
    if reqap["resbool"] == True:
        if request.method == "GET":
            if request.cookies.get("c_user") != None or request.cookies.get("xs") != None:
                authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
                c_user = request.cookies.get("c_user")
                xs = request.cookies.get("xs")
                # if authi == "unverified_expired":
                #     defaultcont = Markup("""
                #         <h1 id ="heading">მეილის ვერიფიცირების დრო ამოიწურა</h1>
                #         <div id = "nosymbol">
                        
                #         </div>
                #     """)
                if authi == "unverified":
                # elif authi == "unverified":
                    db = sqlite3.connect()
                    kurs = db.cursor()
                    kurs.execute("SELECT * FROM users WHERE id = %(id)s;",{"id" : c_user})
                    kursf = kurs.fetchone()
                    
                    defaultcont = Markup("""
                        <h1 id ="heading">მეილის ვერიფიკაცია</h1>
                        <p id = "agwera">"""+ str(kursf[2]) +""" - ზე წარმატებით გამოიგზავნა 6 ნიშნა კოდი</p><br>
                        <input id = "vcode_input" placeholder="6 ნიშნა კოდი" type="number"><br>
                        <div id  ="vcode_manage_div">
                            <div id = "resend_vcode">თავიდან გაგზავნა</div>
                            <div id = "submit">დადასტურება</div>
                        </div>
                    """)
                elif authi == True:
                    defaultcont = Markup("""
                        <h1 id ="heading">მეილი ვერიფიცირებულია</h1>
                        <div id = "checkmark">
                        
                        </div>
                    """)
                    
                else:
                    return redirect("/")
                
                return render_template("confirmation.html",maincont=defaultcont,bg=Markup(render_template("bg.html")),navbar=Markup(render_template("navbar.html")) )
            else:
                return redirect("/signup")
        elif request.method == "POST":
            if request.cookies.get("c_user") != None or request.cookies.get("xs") != None:
                authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
                c_user = request.cookies.get("c_user")
                xs = request.cookies.get("xs")
                if authi == "unverified" or authi == "unverified_expired":
                    input_vcode = request.form["vcode"]
                    db = sqlite3.connect()
                    kurs = db.cursor()
                    kurs.execute("SELECT vcode, user_creation_time FROM users WHERE id = %(id)s",{"id" : int(c_user)})
                    kursf= kurs.fetchone()
                    if kursf != None:
                        if int(kursf[0]) == int(input_vcode) and ((  int(kursf[1]) + (60*10) ) > int(time.time()) ) :
                            result =  "success"
                            kurs.execute("UPDATE users SET vcode = 1 WHERE id = %(id)s",{"id" : c_user})
                            db.commit()
                        elif  (int(kursf[1]) + (60*10)) < (int(time.time()) ):
                            result =  "ვერიფიკაციის დრო ამოიწურა"
                        elif int(kursf[0]) != int(input_vcode):
                            result =  "არასწორი კოდი"
                        
                        return json.dumps({"result" : result})

                        #i[1] > aefaefa and vcode == vcode
                        # if kursf[1] > 
                    # actual_vcode = 



def mailsend(mail,vcode):
    message = MIMEMultipart()
    message['From'] = from_address
    message['To'] = ""
    body = """
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>GeorgianBase მეილის ვერიფიკაცია</title>
            <style>
            @media only screen and (min-width:800px){
                #maindiv{
                    position:relative;
                    background-color:black;
                    color:white;
                    text-align:center;
                    width:60%;
                    height:325px;
                    left:50%;
                    top:50%;
                    transform:translate(-50%,-50%);
                    

                }
                #vcode{
                    position:relative;
                    left:50%;
                    transform:translate(-50%,0);
                    color:red;
                    font-size:40px;
                }
                hr{
                    backgorund-color:white;
                    color:white;
                }
                p{
                    padding: 22px;
                    font-size: 25px;
                }
                .highlight{
                    color:red;
                }
            }
            @media only screen and (max-width:800px){
                body{
                    overflow:auto;
                }
                #maindiv{
                    position:relative;
                    background-color:black;
                    color:white;
                    text-align:center;
                    width:90%;
                    height:525px;
                    left:50%;
                    top:50%;
                    transform:translate(-50%,-50%);
                    

                }
                #vcode{
                    display:block;
                    position:relative;
                    left:50%;
                    transform:translate(-50%,0);
                    color:red;
                    font-size:40px;
                    width:100%;
                    height:fit-content;
                }
                hr{
                    backgorund-color:white;
                    color:white;
                }
                p{
                    padding: 22px;
                    font-size: 25px;
                }
                .highlight{
                    color:red;
                }
            }
            </style>
        </head>
        <body>
        <center><h1>მეილის ვერიფიკაცია <span class = "highlight">GeorgianBase</span></h1></center><br>
        <center>
            <div id = "maindiv">
            <p>დააკოპირეთ 6 ნიშნა კოდი და ჩასვით GeorgiaBase-ის Confirmation გვერდზე</p>
            <hr>
            <h2 id = "vcode">
                """+ str(vcode)  +"""
            </h2>
                
            </div>
        </center>
            
        </body>
        </html>
    """
    
    message['Subject'] = "GeorgianBase მეილის ვერიფიკაცია"
    message.attach(MIMEText(body, 'html'))
    text = message.as_string()
    
    try:
        server.sendmail(from_address,mail , text)
    except:
        print("reloggining")
        server =  smtplib.SMTP(smtp_server, smtp_port)
        server.starttls()
        server.login(smtp_username, smtp_password)
        server.sendmail(from_address,mail , text)

    


@app.route("/signup",methods=["GET","POST"])
def signup():
    reqap = reqapprove(request,"/signup")
    if reqap["resbool"] == True:
        if request.method == "GET":
            if request.cookies.get("c_user") != None or request.cookies.get("xs") != None:
                authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
                if authi != True:
                    return render_template("signup.html",bg=Markup(render_template("bg.html")),navbar=Markup(render_template("navbar.html")) )
                else:
                    return redirect("/")
            else:
                # return "faefaefaefeaf"
                return render_template("signup.html",bg=Markup(render_template("bg.html")),navbar=Markup(render_template("navbar.html")) )
        elif request.method == "POST":
            db = sqlite3.connect()
            kurs = db.cursor()
            resbool = "false"
            eror_msg = ""
            mail = request.form["mail"]
            xs = ""
            c_user = ""
            kurs.execute("SELECT * FROM users WHERE mail = %(mail)s and vcode = 1",{"mail" : mail})
            kursf = kurs.fetchall()

            print("tttt",kursf)
            if kursf == []:
                if len(mail) > 0 and ("@" in mail) == True and len(mail) <= 40  and len(request.form["xs"]) <= 100:
                    if len(request.form["xs"]) > 8:
                        
                        xs = hashlib.md5((premd+request.form["xs"] + postmd).encode("utf-8")).hexdigest()

                        

                        ip = reqap["ip"] #request.environ.get('HTTP_X_FORWARDED_FOR', request.remote_addr)
                        vcode = random.randint(100000,999999)
                        kurs.execute("INSERT INTO users(ip,mail,password,vcode,user_creation_time,refstr) VALUES(%s,%s,%s,%s,%s,%s)",(ip,mail,hashlib.sha256((presha + xs + postsha).encode("utf-8")).hexdigest(),vcode,int(time.time()), ranstr(50) ))
                        
                        db.commit()
                        c_user = kurs.lastrowid
                        resbool = "true"
                        threading.Thread(target=mailsend,args=(mail,vcode)).start()
                        
            else:
                eror_msg = "მეილი დაკავებულია"
                
        
        return json.dumps({"resbool" : resbool,"c_user" : c_user, "xs" : xs,"eror_msg" : eror_msg})


def saxelis_shiflacia(txt):
    georgian_alphabet = {
    "ა": "a",
    "ბ": "b",
    "გ": "g",
    "დ": "d",
    "ე": "e",
    "ვ": "v",
    "ზ": "z",
    "თ": "t",
    "ი": "i",
    "კ": "k",
    "ლ": "l",
    "მ": "m",
    "ნ": "n",
    "ო": "o",
    "პ": "p",
    "ჟ": "j",
    "რ": "r",
    "ს": "s",
    "ტ": "t",
    "უ": "u",
    "ფ": "f",
    "ქ": "q",
    "ღ": "R",
    "ყ": "y",
    "შ": "S",
    "ჩ": "C",
    "ც": "c",
    "ძ": "Z",
    "წ": "w",
    "ჭ": "W",
    "ხ": "x",
    "ჯ": "j",
    "ჰ": "h"
    }
    texti = txt
    for i in georgian_alphabet:
        texti = texti.replace(i,georgian_alphabet[i])
    return texti.strip().lower()

def saxelis_damushaveba(saxeli_src):
    return saxelis_shiflacia(saxeli_src.strip().lower()).replace("chk","wy").replace("ch","c").replace("dz","z").replace("kh","x").replace("sh","s").replace("gh","r")



@app.route("/search_data",methods=["GET","POST"])
def search_data():
    payload = {}
    for i in request.form:
        payload[i] = request.form[i]
    searchtype = request.form["searchtype"]
    reqap = reqapprove(request,"/search_data",payload=payload)
    if  searchtype == "import":
        gateway_bool = reqap["resbool"] 
    else:
        gateway_bool = True
    if gateway_bool == True:
        db = sqlite3.connect()
        kurs = db.cursor()

        kurs.execute("SELECT * FROM searches WHERE  searcher_ip = %(ip)s ;",{"ip" : reqap["ip"]})
        
        modzebnis_raodenoba = len(kurs.fetchall())
        darchenili_modzebnis_raodenoba = 5 - modzebnis_raodenoba

        c_user = request.cookies.get("c_user")
        xs = request.cookies.get("xs")
        premiumi = premium(c_user,xs)
        if darchenili_modzebnis_raodenoba > 0 or searchtype == "add" or premiumi:

            if searchtype == "import":
                
                ip = str(reqap["ip"])
                kurs.execute("INSERT INTO searches(searcher_ip) VALUES(%s)", (ip ,) )
            
                payload = json.dumps(payload)
                if c_user == None:
                    c_useri = None
                else:
                    c_useri = int(c_user)
                kurs.execute("INSERT INTO person_searches(payload ,c_user   ,ip    , search_time  ) VALUES(%s,%s,%s,%s)",(   payload , c_useri ,   ip ,       int(time.time())   ) )
                db.commit()

            darcha_modzebnis_raodenoba = darchenili_modzebnis_raodenoba - 1
            # search_data_query_ls = []
            search_data_query_ls = {}
            

            # print(type(request.headers.get("Content-Type")),"';';';';'",request.headers.get("Content-Type"))
            user_agent = request.headers.get("User-Agent")
            # print("jsjssjjjjj",request.form)


            

            if request.form["region_datatype"] == "ind":
                region = locations_en[int(request.form["region"])]
            elif request.form["region_datatype"] == "ind_en":
                region = locations_en[int(request.form["region"])]
            elif request.form["region_datatype"] == "txt":
                region = request.form["region"].strip()
            
            if region == "ყველა" or region == "":
                region_query = ""
            else:
                region_query = " AND (lower(qucha) LIKE '%"+ region +"%'  OR lower(reg) LIKE '%"+  region  +"%') "
            # print("ahh",region_query)

            # if request.cookies.get("c_user") != None:
            if False:
                key =  enc_keys[request.cookies.get("enc_key").decode("utf-8")] #request.cookies.get("enc_key").encode("utf-8")
                fernet = Fernet(key)
                # print(user_agent.split()[1].split(";")[1])
                saxeli_src = fernet.decrypt(request.form["saxeli"].encode("utf-8")).decode("utf-8")
                gvari_src = fernet.decrypt(request.form["gvari"].encode("utf-8")).decode("utf-8")
                alt_gvari_src = fernet.decrypt(request.form["gvari"].encode("utf-8")).decode("utf-8")
            else:
                saxeli_src = request.form["saxeli"]
                gvari_src = request.form["gvari"]
                alt_gvari_src = request.form["gvari"]
            

            
            outer_break = False
            alt_names_suggs = []
            for i in alt_names:
                for name in i:
                    if saxelis_damushaveba(name) == saxelis_damushaveba(saxeli_src):
                        alt_names_suggs = i
                        outer_break = True
                        break
                
                if outer_break:
                    break
            
            saxeli = saxelis_damushaveba(saxeli_src) #saxeli_src.lower().replace("chk","wy").replace("ch","c").replace("dz","z").replace("kh","x").replace("sh","s")
            gvari = saxelis_shiflacia(gvari_src).lower().replace("chk","wy").replace("ch","c").replace("dz","z").replace("kh","x").replace("sh","s")
            alt_gvari = saxelis_shiflacia(alt_gvari_src).lower().replace("chk","wy").replace("ch","w").replace("dz","z").replace("kh","x").replace("sh","s")
            platform = request.form["platform"]

            if alt_names_suggs == []:
                # saxeli_queri = " lower(saxeli) = :saxeli "
                saxeli_queri = " lower(saxeli) = %(saxeli)s "
                

                # search_data_query_ls += [saxeli]
                search_data_query_ls["saxeli"] =  [saxeli]
                
            else:
                saxeli_queri = ""


                

                # search_data_query_ls+= list(map(lambda x: x.lower() ,alt_names_suggs))

                # alt_names_suggs = tuple(map(lambda x :  "?" ,alt_names_suggs))
                # alt_names_suggs = str(tuple(alt_names_suggs)).replace('"','').replace("'","")


                # alt_names_suggs = tuple(map(lambda x :  '"' + x.lower() + '"' ,alt_names_suggs))
                alt_names_suggs = tuple(map(lambda x :  x.lower()  ,alt_names_suggs))
                
                # print(alt_names_suggs)
                # alt_names_suggs = str(tuple(alt_names_suggs)).replace('"','').replace("'","")
                saxeli_queri+=  (" lower(the_database.saxeli)  IN  "+ str(alt_names_suggs) +" ")

                
                # for i in alt_names_suggs:
                #     saxeli_queri+=  (" lower(saxeli) =  '" + saxelis_damushaveba( i) + "' OR ")
                # saxeli_queri+= " 1=2"



            
            results = ""
            geotve = ["იანვარი","თებერვალი","მარტი","აპრილი","მაისი","ივნისი","ივლისი","აგვისტო","სექტემბერი","ოქტომბერი","ნოემბერი","დეკემბერი"]
            data = {}

            authi = auth(request.cookies.get("c_user"),request.cookies.get("xs"))
            


            additional_query_data = ""
            additional_param_data = ""
            additional_where_data = ""
            if authi == True:
                additional_query_data += " LEFT JOIN saved_rows ON the_database.pir_nomeri = piradobis_nomeri_id "
                additional_param_data += ", saver_id "
                # additional_where_data += " AND ( saver_id = "+ str(request.cookies.get("c_user")) +" OR saver_id IS NULL ) "
                additional_where_data += " AND ( saved_rows.saver_id = %(c_user)s OR saved_rows.saver_id IS NULL ) "
                
            ixi = 0

            searchtoken = request.form["searchtoken"]

            min_asaki = int(request.form["min_asaki"].strip())
            max_asaki = int(request.form["max_asaki"].strip())

            def search_data_asakfilter(x):
                if str(x[5]) != "None":
                    dab_tarigi = str(x[5])

                    ax_weli = int(str(datetime.datetime.now()).split("-")[0])
                    ax_tve_i = int(str(datetime.datetime.now()).split("-")[1])
                    ax_ricxvi_i = int(str(datetime.datetime.now()).split("-")[2].split()[0])
                    weli = int(dab_tarigi.split(".")[2])


                    ricxvi = int(dab_tarigi.split(".")[0])
                    tve_i = int((dab_tarigi.split(".")[1]))
                    tve = geotve[tve_i-1]
                    wsxvaoba = str(ax_weli-weli)
                    dabadebis_tarigi = f"{weli} წელი {ricxvi} {tve}"
                    asaki = int(int((float(ax_weli) + float(ax_tve_i/12) + float(ax_ricxvi_i/365)) - ((float(weli))+ float(tve_i/12) + float(ricxvi/365))))
                    if asaki >= min_asaki and asaki <= max_asaki:
                        return True
                    else:
                        return False
                else:
                    return True

            

            # search_data_query_ls += [gvari,alt_gvari]
            search_data_query_ls["gvari"] = gvari
            search_data_query_ls["alt_gvari"] = alt_gvari
            
            

            if authi == True:
                # search_data_query_ls+= [str(request.cookies.get("c_user"))]
                search_data_query_ls["c_user"] = str(c_user)
            if  searchtype == "import":
                kurs.execute(
                            # "SELECT pir_nomeri , gvari , saxeli , mama , sqesi , dabweli , qucha , reg  "+ additional_param_data +"  FROM database "+ additional_query_data +"   WHERE     ( ("+ saxeli_queri  +") AND (lower(gvari) = :gvari OR lower(gvari) = :alt_gvari ) "+ region_query +"  ) "+ additional_where_data +"   ;"
                            "SELECT the_database.pir_nomeri , the_database.gvari , the_database.saxeli , the_database.mama , the_database.sqesi , the_database.dabweli , the_database.qucha , the_database.reg  "+ additional_param_data +"  FROM the_database "+ additional_query_data +"   WHERE     ( ("+ saxeli_queri  +") AND (lower(the_database.gvari) = %(gvari)s OR lower(the_database.gvari) = %(alt_gvari)s ) "+ region_query +"  ) "+ additional_where_data +"   ;"
                            
                            # ,{"saxeli" : saxeli,"gvari" : gvari, "alt_gvari" : alt_gvari,"c_user" : str(request.cookies.get("c_user"))}
                            # ,tuple(search_data_query_ls)
                            ,search_data_query_ls
                            
                            
                            )
                df = np.array(kurs.fetchall())
                # print("zoma",len(df))
                df = np.array(list(filter(search_data_asakfilter,df)))
                # print("zoma",len(df))
                

                pirovnebata_raodenoba = str(len(df))
                continuing_searches[searchtoken] = {"df" : df,"creation_time" : int(time.time()) }

                datafreimi = df
                df = df[:10]
                
            elif searchtype == "add":

                # time.sleep(3)
                pirovnebata_raodenoba = 0

                fromi = int(request.form["searchtype_from"])
                to = fromi + 10
                # print("range",fromi,"-",to)
                datafreimi = continuing_searches[searchtoken]["df"]
                df = datafreimi[fromi:to]
                ixi = fromi
            

            

                

            
            for i in df:
                try:
                    if True:
                    # if(  saxeli.lower() == i[2].lower() and (gvari.lower() == i[1].lower() or alt_gvari.lower() == i[1].lower() )    ):
                        
                        
                        if str(i[0]) != "None":

                            ixi+=1
                            piradobis_nomeri = str(i[0]).replace(".0","")

                            
                            
                            if str(i[7]) != "None":
                                regioni = i[7]
                            else:
                                regioni = "უცნობი"
                            if str(i[6]) != "None":
                                sacxovrebeli_qucha = i[6]
                            else:
                                sacxovrebeli_qucha = "უცნობი"

                            if str(i[5]) != "None":
                                dab_tarigi = str(i[5])

                                ax_weli = int(str(datetime.datetime.now()).split("-")[0])
                                ax_tve_i = int(str(datetime.datetime.now()).split("-")[1])
                                ax_ricxvi_i = int(str(datetime.datetime.now()).split("-")[2].split()[0])
                                weli = int(dab_tarigi.split(".")[2])


                                ricxvi = int(dab_tarigi.split(".")[0])
                                tve_i = int((dab_tarigi.split(".")[1]))
                                tve = geotve[tve_i-1]
                                wsxvaoba = str(ax_weli-weli)
                                dabadebis_tarigi = f"{weli} წელი {ricxvi} {tve}"
                                asaki = str(int((float(ax_weli) + float(ax_tve_i/12) + float(ax_ricxvi_i/365)) - ((float(weli))+ float(tve_i/12) + float(ricxvi/365))))
                            
                            else:
                                asaki = "უცნობი"
                                dabadebis_tarigi = "უცნობი"
                            



                            data[piradobis_nomeri] = {} #saxeligvari , sqesi, dabadeba, asaki, mama, sacxovrebeli qucha, regioni
                            data[piradobis_nomeri]["saxeligvari"] = saxeli + " " + gvari
                            if str(i[4]) != "None":
                                if int(float(str(i[4]))) == 1:
                                    sqesi = "მამრობითი"
                                elif int(float(str(i[4]))) == 2:
                                    sqesi = "მდედრობითი"
                                
                            else:
                                sqesi = "უცნობი"

                            if str(i[3]) != "None":
                                mama = i[3] + " " + gvari
                            else:
                                mama = "უცნობი"

                            data[piradobis_nomeri]["dabadebis_tarigi"] = dabadebis_tarigi
                            data[piradobis_nomeri]["asaki"] = asaki
                            data[piradobis_nomeri]["mama"] = mama
                            data[piradobis_nomeri]["sacxovrebeli_qucha"] = sacxovrebeli_qucha
                            data[piradobis_nomeri]["regioni"] = regioni
                            data[piradobis_nomeri]["sqesi"] = sqesi

                            if authi == True:
                                if i[8] == None:
                                    data[piradobis_nomeri]["saved_bool"] = "false"
                                else:
                                    data[piradobis_nomeri]["saved_bool"] = "true"

                            
                            if piradobis_nomeri == str(datafreimi[::-1][0,0]):
                                last_row = "true"
                            else:
                                last_row = "false"
                            
                            data[piradobis_nomeri]["last_row"] = last_row
                            
                            results+= f""" <div id = "result_row_{piradobis_nomeri}" last_row = "{last_row}" class = "result_row result_row_{str(ixi)}">
                                <div id = "result_row_piradoba_{piradobis_nomeri}" class = "result_row_piradoba result_row_child">🆔{piradobis_nomeri}</div>
                                <div id = "result_row_regioni_{piradobis_nomeri}" class = "result_row_regioni result_row_child">📍{regioni}</div>
                                <div id = "result_row_asaki_{piradobis_nomeri}" class = "result_row_asaki  result_row_child">🎂{asaki}</div>
                                <div id = "result_row_morebtn_{piradobis_nomeri}" piradobis_nomeri = "{piradobis_nomeri}" class = "result_row_morebtn  result_row_child">მეტი</div>
                                

                            </div>   """
                            
                except Exception as e:
                    print("erori",e,i)


            if results == "":
                # return "notfound"
                return json.dumps(["notfound",darcha_modzebnis_raodenoba])
            else:
                return json.dumps([results,data,pirovnebata_raodenoba,darcha_modzebnis_raodenoba])
        else:
            return "no_more_free_searches"
    else:
        return reqap["resbool"]

@app.route("/admin")
def admin():
    pass

@app.route("/admin_login")
def admin_login():
    pass

@app.route("/admin_credit")
def admin_credit():
    pass

if production:
    porti = 80
else:
    porti = 5000


if production:
    debugi = False
else:
    debugi = True

print('starting')
if __name__ == "__main__":
    # app.run(debug=False,host="0.0.0.0",port=porti)
    socketio.run(app
                 ,debug=debugi,host="0.0.0.0",port=porti
                 )